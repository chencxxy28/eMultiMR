<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tutorial â€¢ eMultiR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Tutorial">
<meta property="og:description" content="eMultiR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">eMultiR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/NAME-OF-VIGNETTE.html">Tutorial</a>
    </li>
    <li>
      <a href="../articles/web/data.html">Data download</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Tutorial</h1>
            
      
      
      <div class="hidden name"><code>NAME-OF-VIGNETTE.Rmd</code></div>

    </div>

    
    
<p><strong>eMultiR</strong> is a multiply robust framework for
estimation of causal effect under the setting with a binary outcome,
where multiple propensity score models and conditional mean imputation
models are used to ensure estimation robustness. Moreover,
<strong>eMultiR</strong> reduces estimation variability by incorporating
secondary outcomes that are highly correlated with the primary binary
outcome. The resulting estimates are less sensitive to model
mis-specification compared to that based on the existing
state-of-the-art methods (e.g., doubly robust estimators).</p>
<div class="section level1">
<h1 id="installation-the-package">Installation the package<a class="anchor" aria-label="anchor" href="#installation-the-package"></a>
</h1>
<p>To begin with, the user need to install our packages</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://devtools.r-lib.org/" class="external-link">"devtools"</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/remote-reexports.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"chencxxy28/eMultiR"</span><span class="op">)</span></code></pre></div>
<p>load necessary packages for this tutorial</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://personality-project.org/r/psych/" class="external-link">psych</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">rootSolve</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://mvtnorm.R-forge.R-project.org" class="external-link">mvtnorm</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">bindata</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">geepack</span><span class="op">)</span> 
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">eMultiR</span><span class="op">)</span>
<span class="va">readRDSFromWeb</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">ref</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/gzcon.html" class="external-link">gzcon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/connections.html" class="external-link">url</a></span><span class="op">(</span><span class="va">ref</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
</div>
<div class="section level1">
<h1 id="simulate-the-data">Simulate the data<a class="anchor" aria-label="anchor" href="#simulate-the-data"></a>
</h1>
<p>The basic setups</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n</span><span class="op">=</span><span class="fl">10000</span> <span class="co"># sample size; change to a smaller value</span>
<span class="va">proportion</span><span class="op">&lt;-</span><span class="fl">1</span> <span class="co"># proportion of having secondary outcomes</span>
<span class="va">correlation</span><span class="op">&lt;-</span><span class="fl">0.4</span> <span class="co">#correlation among secondary outcomes</span>
<span class="va">variance</span><span class="op">&lt;-</span><span class="fl">1</span> <span class="co">#residual variance</span>
<span class="va">time</span><span class="op">&lt;-</span><span class="fl">4</span> <span class="co">#time point</span>
<span class="va">id</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span>,each<span class="op">=</span><span class="va">time</span><span class="op">)</span> <span class="co">#subject id </span>
<span class="va">etaT_1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="co">#coefficients in the conditional mean model for treatment group</span>
<span class="va">etaT_2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="op">-</span><span class="fl">2</span><span class="op">)</span> <span class="co">#coefficients in the conditional mean model for the control group</span>
<span class="va">gammaT</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.6</span>,<span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span> <span class="co">#coefficients for the treatment assignment model</span>
<span class="va">betaT</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span> <span class="co">#coefficients for the secondary outcomes</span>
<span class="va">R_var</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/ar1_cor.html">ar1_cor</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">correlation</span><span class="op">)</span> <span class="co">#construct the ar1 correlation structure for secondary outcomes</span>
<span class="va">R_var_x</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/ar1_cor.html">ar1_cor</a></span><span class="op">(</span><span class="va">time</span>,<span class="fl">0.4</span><span class="op">)</span> <span class="co">#construct the ar1 correlation structure for longitudinal covariates</span>

<span class="va">casual_effect</span><span class="op">&lt;-</span><span class="fl">1.885925</span> <span class="co">#true casual odds ratio based on simulation</span></code></pre></div>
<p>The following code is to simulate one main and secondary data</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234567</span><span class="op">)</span>
<span class="co">#generate data</span>
  <span class="va">y</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">)</span>
  <span class="va">yy_1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">)</span>
  <span class="va">yy_2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">)</span>
  <span class="va">x</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">)</span>
  <span class="va">x_reg</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">)</span>
  <span class="va">prob</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">)</span>
  <span class="va">trt_a</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">)</span>
  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span>
  <span class="op">{</span>
    <span class="co">#generate observed and counterfactual outcomes</span>
    <span class="va">x3_i</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,time<span class="op">=</span><span class="va">time</span><span class="op">)</span>
    <span class="va">x2_i</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0.5</span><span class="op">)</span>,time<span class="op">=</span><span class="va">time</span><span class="op">)</span>
    <span class="va">x_i</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">x2_i</span>, <span class="va">x3_i</span><span class="op">)</span>
    <span class="va">x_reg_1_i</span><span class="op">&lt;-</span><span class="va">x_reg_2_i</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">x2_i</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="va">x3_i</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>
    <span class="va">allresidual1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">1</span>,mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">time</span><span class="op">)</span>,sigma<span class="op">=</span><span class="va">R_var</span><span class="op">)</span>
    <span class="va">allresidual2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">1</span>,mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">time</span><span class="op">)</span>,sigma<span class="op">=</span><span class="va">R_var</span><span class="op">)</span>
    <span class="va">residual_1_i</span><span class="op">&lt;-</span><span class="va">allresidual1</span><span class="op">[</span><span class="va">time</span><span class="op">]</span>
    <span class="va">residual_2_i</span><span class="op">&lt;-</span><span class="va">allresidual2</span><span class="op">[</span><span class="va">time</span><span class="op">]</span>
    <span class="va">prob_x_10</span><span class="op">&lt;-</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">x_reg_1_i</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">etaT_1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>
    <span class="va">prob_x_20</span><span class="op">&lt;-</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">x_reg_2_i</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">etaT_2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>
    <span class="va">x_10</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">prob_x_10</span><span class="op">)</span>
    <span class="va">x_20</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">prob_x_20</span><span class="op">)</span>
    <span class="va">yy_1_i</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">residual_1_i</span><span class="op">&gt;=</span><span class="va">x_10</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>
    <span class="va">yy_2_i</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">residual_2_i</span><span class="op">&gt;=</span><span class="va">x_20</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>
    
    <span class="co">#generate treatment assignment</span>
    <span class="va">u_var</span><span class="op">&lt;-</span><span class="va">x2_i</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="va">x3_i</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">+</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
    <span class="va">x_reg_trt_i</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x_reg_1_i</span>,<span class="va">u_var</span><span class="op">)</span>
    <span class="va">prob_i</span><span class="op">&lt;-</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">x_reg_trt_i</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">gammaT</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>
    <span class="va">trt_a_i</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,prob <span class="op">=</span> <span class="va">prob_i</span><span class="op">)</span>

    <span class="co">#generate a longitudinal secondary outcomes</span>
    <span class="va">x_i</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">x_i</span>,<span class="va">trt_a_i</span><span class="op">*</span><span class="va">x_i</span><span class="op">)</span>
    <span class="va">residual_updated_i</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">allresidual1</span><span class="op">*</span><span class="va">trt_a_i</span><span class="op">+</span><span class="va">allresidual2</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">trt_a_i</span><span class="op">)</span><span class="op">)</span>
    <span class="va">y_i</span><span class="op">&lt;-</span><span class="op">(</span><span class="va">x_i</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">betaT</span><span class="op">)</span><span class="op">+</span><span class="va">residual_updated_i</span>
    <span class="va">y</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">y</span>,<span class="va">y_i</span><span class="op">)</span>
    <span class="va">x</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">x_i</span><span class="op">)</span>
    <span class="va">yy_1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">yy_1</span>,<span class="va">yy_1_i</span><span class="op">)</span>
    <span class="va">yy_2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">yy_2</span>,<span class="va">yy_2_i</span><span class="op">)</span>
    <span class="va">prob</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">prob</span>,<span class="va">prob_i</span><span class="op">)</span>
    <span class="va">x_reg</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">x_reg</span>,<span class="va">x_reg_trt_i</span><span class="op">)</span>
    <span class="va">trt_a</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">trt_a</span>,<span class="va">trt_a_i</span><span class="op">)</span>
  <span class="op">}</span>
  
  <span class="co">#construct combined and observed outcomes</span>
  <span class="va">yy</span><span class="op">&lt;-</span><span class="va">yy_1</span>
  <span class="va">yy</span><span class="op">[</span><span class="va">trt_a</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">yy_2</span><span class="op">[</span><span class="va">trt_a</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span></code></pre></div>
</div>
<div class="section level1">
<h1 id="compare-different-methods-in-terms-of-estimation-bias">Compare different methods in terms of estimation bias<a class="anchor" aria-label="anchor" href="#compare-different-methods-in-terms-of-estimation-bias"></a>
</h1>
<p>We provide the following codes to calculate the eMultiR estimate
without information borrow from the secondary outcomes given two
candidate models for the propensity scores (PS) and conditional means
(CM), none of which are correctly specified. To prepare the estimation,
we need to fit the PS models and CM models first. Consider the following
three PS models: the right model, wrong model1, and wrong model2. The
following code requires substantial running time due to sample size of
10000, in order to stabilize the estimation. The user can directly run
the code in the session of <code>Read estimate results directly</code>
to visualize the estimation bias. The user can also make the sample size
<code>n</code> smaller, such as n=300.</p>
<div class="section level2">
<h2 id="the-model-based-on-iptw-method">The model based on IPTW method<a class="anchor" aria-label="anchor" href="#the-model-based-on-iptw-method"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">######propensity score model</span>
  <span class="co">#fit logistic regression under right model</span>
  <span class="va">fit</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">trt_a</span><span class="op">~</span><span class="va">x_reg</span><span class="op">-</span><span class="fl">1</span>,family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span><span class="op">)</span>
  <span class="va">eta_pi_initial</span><span class="op">&lt;-</span><span class="va">fit</span><span class="op">$</span><span class="va">coefficients</span>
  <span class="va">prob_fitted_right</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>

  <span class="co">#fit logistic regression under wrong model 1</span>
  <span class="va">fit</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">trt_a</span><span class="op">~</span><span class="va">x_reg</span><span class="op">[</span>,<span class="op">-</span><span class="fl">3</span><span class="op">]</span><span class="op">-</span><span class="fl">1</span>,family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span><span class="op">)</span>
  <span class="va">eta_pi_initial</span><span class="op">&lt;-</span><span class="va">fit</span><span class="op">$</span><span class="va">coefficients</span>
  <span class="va">prob_fitted_wrong</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>

  <span class="co">#fit logistic regression under wrong model 2</span>
  <span class="va">fit</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">trt_a</span><span class="op">~</span><span class="va">x_reg</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="op">-</span><span class="fl">1</span>,family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span><span class="op">)</span>
  <span class="va">eta_pi_initial</span><span class="op">&lt;-</span><span class="va">fit</span><span class="op">$</span><span class="va">coefficients</span>
  <span class="va">prob_fitted_wrong2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></code></pre></div>
<p>Given the above model, run the codes to obtain the IPTW estimates due
to different candidate models</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#conventional iptw</span>
<span class="va">eta_iptw</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#construct iptw weight:right</span>
  <span class="va">eta</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/iptw.binary.html">iptw.binary</a></span><span class="op">(</span>prob_fit<span class="op">=</span><span class="va">prob_fitted_right</span>,trt_ind<span class="op">=</span><span class="va">trt_a</span>,main_outcome<span class="op">=</span><span class="va">yy</span><span class="op">)</span>
  <span class="va">eta_iptw</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">eta_iptw</span>,<span class="va">eta</span><span class="op">)</span>
  <span class="co">#construct iptw weight:wrong1</span>
  <span class="va">eta</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/iptw.binary.html">iptw.binary</a></span><span class="op">(</span>prob_fit<span class="op">=</span><span class="va">prob_fitted_wrong</span>,trt_ind<span class="op">=</span><span class="va">trt_a</span>,main_outcome<span class="op">=</span><span class="va">yy</span><span class="op">)</span>
  <span class="va">eta_iptw</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">eta_iptw</span>,<span class="va">eta</span><span class="op">)</span>
  <span class="co">#construct iptw weight:wrong2</span>
  <span class="va">eta</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/iptw.binary.html">iptw.binary</a></span><span class="op">(</span>prob_fit<span class="op">=</span><span class="va">prob_fitted_wrong2</span>,trt_ind<span class="op">=</span><span class="va">trt_a</span>,main_outcome<span class="op">=</span><span class="va">yy</span><span class="op">)</span>
  <span class="va">eta_iptw</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">eta_iptw</span>,<span class="va">eta</span><span class="op">)</span></code></pre></div>
<p>Evaluate the estimation bias</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">eta_iptw</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span><span class="op">-</span><span class="va">casual_effect</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="the-model-based-on-cm-method">The model based on CM method<a class="anchor" aria-label="anchor" href="#the-model-based-on-cm-method"></a>
</h2>
<p>Consider the following three CM models: the right model, wrong
model1, and wrong model2</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#######regression model</span>
  <span class="co">#fit correct model</span>
  <span class="va">data.used.reg</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">x_reg</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>,<span class="va">trt_a</span>,<span class="va">x_reg</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">trt_a</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">data.used.reg</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x1"</span>,<span class="st">"x2"</span>,<span class="st">"x3"</span>,<span class="st">"trt"</span>,<span class="st">"x1trt"</span>,<span class="st">"x2trt"</span>,<span class="st">"x3trt"</span><span class="op">)</span>
  <span class="va">fit</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">yy</span><span class="op">~</span><span class="va">x1</span><span class="op">+</span><span class="va">x2</span><span class="op">+</span><span class="va">x3</span><span class="op">+</span><span class="va">trt</span><span class="op">+</span><span class="va">x1trt</span><span class="op">+</span><span class="va">x2trt</span><span class="op">+</span><span class="va">x3trt</span>,family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span>,data<span class="op">=</span><span class="va">data.used.reg</span><span class="op">)</span>
  <span class="va">pseudo_y.obs</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit</span>,type <span class="op">=</span><span class="st">"response"</span><span class="op">)</span>
  
  <span class="va">newdata.trt1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">x_reg</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>,<span class="fl">1</span>,<span class="va">x_reg</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="fl">1</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">newdata.trt1</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x1"</span>,<span class="st">"x2"</span>,<span class="st">"x3"</span>,<span class="st">"trt"</span>,<span class="st">"x1trt"</span>,<span class="st">"x2trt"</span>,<span class="st">"x3trt"</span><span class="op">)</span>
  <span class="va">pseudo_y.trt1.right</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit</span>,<span class="va">newdata.trt1</span>,type <span class="op">=</span><span class="st">"response"</span><span class="op">)</span>
  
  <span class="va">newdata.trt0</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">x_reg</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>,<span class="fl">0</span>,<span class="va">x_reg</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="fl">0</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">newdata.trt0</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x1"</span>,<span class="st">"x2"</span>,<span class="st">"x3"</span>,<span class="st">"trt"</span>,<span class="st">"x1trt"</span>,<span class="st">"x2trt"</span>,<span class="st">"x3trt"</span><span class="op">)</span>
  <span class="va">pseudo_y.trt0.right</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit</span>,<span class="va">newdata.trt0</span>,type <span class="op">=</span><span class="st">"response"</span><span class="op">)</span>
  
  <span class="va">data.impute</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>pseudo_y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pseudo_y.trt1.right</span>,<span class="va">pseudo_y.trt0.right</span><span class="op">)</span>,
                          trt<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">pseudo_y.trt1.right</span><span class="op">)</span><span class="op">)</span>,
                                <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">pseudo_y.trt0.right</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
  <span class="co">#or</span>
  <span class="va">fit</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">pseudo_y</span><span class="op">~</span><span class="va">trt</span>,family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span>,data<span class="op">=</span><span class="va">data.impute</span><span class="op">)</span>
  <span class="va">est.or.right.all</span><span class="op">&lt;-</span><span class="va">fit</span><span class="op">$</span><span class="va">coefficients</span>
  <span class="co">#est.or.right.all.pool&lt;-cbind(est.or.right.all.pool,est.or.right.all)</span>

<span class="co">#fit wrong model 2</span>
  <span class="va">data.used.reg</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">x_reg</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>,<span class="va">trt_a</span>,<span class="va">x_reg</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span><span class="op">*</span><span class="va">trt_a</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">data.used.reg</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x2"</span>,<span class="st">"x3"</span>,<span class="st">"trt"</span>,<span class="st">"x2trt"</span>,<span class="st">"x3trt"</span><span class="op">)</span>
  <span class="va">fit</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">yy</span><span class="op">~</span><span class="va">x2</span><span class="op">+</span><span class="va">x3</span><span class="op">+</span><span class="va">trt</span><span class="op">+</span><span class="va">x2trt</span><span class="op">+</span><span class="va">x3trt</span>,family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span>,data<span class="op">=</span><span class="va">data.used.reg</span><span class="op">)</span>
  
  <span class="va">newdata.trt1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">x_reg</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>,<span class="fl">1</span>,<span class="va">x_reg</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span><span class="op">*</span><span class="fl">1</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">newdata.trt1</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x2"</span>,<span class="st">"x3"</span>,<span class="st">"trt"</span>,<span class="st">"x2trt"</span>,<span class="st">"x3trt"</span><span class="op">)</span>
  <span class="va">pseudo_y.trt1.wrong2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit</span>,<span class="va">newdata.trt1</span>,type <span class="op">=</span><span class="st">"response"</span><span class="op">)</span>
  
  <span class="va">newdata.trt0</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">x_reg</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>,<span class="fl">0</span>,<span class="va">x_reg</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span><span class="op">*</span><span class="fl">0</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">newdata.trt0</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x2"</span>,<span class="st">"x3"</span>,<span class="st">"trt"</span>,<span class="st">"x2trt"</span>,<span class="st">"x3trt"</span><span class="op">)</span>
  <span class="va">pseudo_y.trt0.wrong2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit</span>,<span class="va">newdata.trt0</span>,type <span class="op">=</span><span class="st">"response"</span><span class="op">)</span>
  
  <span class="va">data.impute</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>pseudo_y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pseudo_y.trt1.wrong2</span>,<span class="va">pseudo_y.trt0.wrong2</span><span class="op">)</span>,
                          trt<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">pseudo_y.trt1.wrong2</span><span class="op">)</span><span class="op">)</span>,
                                <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">pseudo_y.trt0.wrong2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
  
  <span class="va">fit</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">pseudo_y</span><span class="op">~</span><span class="va">trt</span>,family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span>,data<span class="op">=</span><span class="va">data.impute</span><span class="op">)</span>
  <span class="va">est.or.wrong2.all</span><span class="op">&lt;-</span><span class="va">fit</span><span class="op">$</span><span class="va">coefficients</span>
  <span class="co">#est.or.wrong2.all.pool&lt;-cbind(est.or.wrong2.all.pool,est.or.wrong2.all)</span>
  
  
<span class="co">#fit wrong model 1</span>
  <span class="va">data.used.reg</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">x_reg</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>,<span class="va">trt_a</span>,<span class="va">x_reg</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span><span class="op">*</span><span class="va">trt_a</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">data.used.reg</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x1"</span>,<span class="st">"x3"</span>,<span class="st">"trt"</span>,<span class="st">"x1trt"</span>,<span class="st">"x3trt"</span><span class="op">)</span>
  <span class="va">fit</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">yy</span><span class="op">~</span><span class="va">x1</span><span class="op">+</span><span class="va">x3</span><span class="op">+</span><span class="va">trt</span><span class="op">+</span><span class="va">x1trt</span><span class="op">+</span><span class="va">x3trt</span>,family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span>,data<span class="op">=</span><span class="va">data.used.reg</span><span class="op">)</span>
  <span class="va">pseudo_y.obs</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit</span>,type <span class="op">=</span><span class="st">"response"</span><span class="op">)</span>
  
  <span class="va">newdata.trt1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">x_reg</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>,<span class="fl">1</span>,<span class="va">x_reg</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span><span class="op">*</span><span class="fl">1</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">newdata.trt1</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x1"</span>,<span class="st">"x3"</span>,<span class="st">"trt"</span>,<span class="st">"x1trt"</span>,<span class="st">"x3trt"</span><span class="op">)</span>
  <span class="va">pseudo_y.trt1.wrong1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit</span>,<span class="va">newdata.trt1</span>,type <span class="op">=</span><span class="st">"response"</span><span class="op">)</span>
  
  <span class="va">newdata.trt0</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">x_reg</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>,<span class="fl">0</span>,<span class="va">x_reg</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span><span class="op">*</span><span class="fl">0</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">newdata.trt0</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x1"</span>,<span class="st">"x3"</span>,<span class="st">"trt"</span>,<span class="st">"x1trt"</span>,<span class="st">"x3trt"</span><span class="op">)</span>
  <span class="va">pseudo_y.trt0.wrong1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit</span>,<span class="va">newdata.trt0</span>,type <span class="op">=</span><span class="st">"response"</span><span class="op">)</span>
  
  <span class="va">data.impute</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>pseudo_y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pseudo_y.trt1.wrong1</span>,<span class="va">pseudo_y.trt0.wrong1</span><span class="op">)</span>,
                          trt<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">pseudo_y.trt1.wrong1</span><span class="op">)</span><span class="op">)</span>,
                                <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">pseudo_y.trt0.wrong1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
  <span class="co">#or</span>
  <span class="va">fit</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">pseudo_y</span><span class="op">~</span><span class="va">trt</span>,family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span>,data<span class="op">=</span><span class="va">data.impute</span><span class="op">)</span>
  <span class="va">est.or.wrong1.all</span><span class="op">&lt;-</span><span class="va">fit</span><span class="op">$</span><span class="va">coefficients</span>
  <span class="co">#est.or.wrong1.all.pool&lt;-cbind(est.or.wrong1.all.pool,est.or.wrong1.all)</span></code></pre></div>
<p>Evaluate the estimation bias</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">est_cm</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">est.or.right.all</span>,<span class="va">est.or.wrong1.all</span>,<span class="va">est.or.wrong2.all</span><span class="op">)</span>
<span class="va">est_cm</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span><span class="op">-</span><span class="va">casual_effect</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="the-dr-estimate-with-all-wrong-model">The DR estimate with all wrong model<a class="anchor" aria-label="anchor" href="#the-dr-estimate-with-all-wrong-model"></a>
</h2>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#dr estimation</span>
<span class="co">#wor wiptw</span>
  <span class="va">est.dr.ww</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/dr.est.html">dr.est</a></span><span class="op">(</span>prob_fit<span class="op">=</span><span class="va">prob_fitted_wrong</span>,trt_ind<span class="op">=</span><span class="va">trt_a</span>,main_outcome<span class="op">=</span><span class="va">yy</span>, pseudo_outcome_obs<span class="op">=</span><span class="va">pseudo_y.obs</span>, pseudo_outcome_comb<span class="op">=</span><span class="va">data.impute</span><span class="op">$</span><span class="va">pseudo_y</span>, pseudo_trt<span class="op">=</span><span class="va">data.impute</span><span class="op">$</span><span class="va">trt</span>
  <span class="op">)</span>

<span class="va">est.dr.ww</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">-</span><span class="va">casual_effect</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="the-model-based-on-emultir-method-without-information-borrow-from-the-secondary-outcomes">The model based on eMultiR method without information borrow from
the secondary outcomes<a class="anchor" aria-label="anchor" href="#the-model-based-on-emultir-method-without-information-borrow-from-the-secondary-outcomes"></a>
</h2>
<p>For the MultiR estimate, we consider two wrong PS models and two
wrong CM models.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="co">#estimating fct for or: trt group</span>
  <span class="va">est.or.fct.trt11</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/est.fct.or.html">est.fct.or</a></span><span class="op">(</span>eta<span class="op">=</span><span class="va">est.or.wrong2.all</span>,pseudo_y<span class="op">=</span><span class="va">pseudo_y.trt1.wrong2</span>,trt<span class="op">=</span><span class="fl">1</span>,n<span class="op">=</span><span class="va">n</span><span class="op">)</span>
  <span class="va">est.or.fct.trt12</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/est.fct.or.html">est.fct.or</a></span><span class="op">(</span>eta<span class="op">=</span><span class="va">est.or.wrong1.all</span>,pseudo_y<span class="op">=</span><span class="va">pseudo_y.trt1.wrong1</span>,trt<span class="op">=</span><span class="fl">1</span>,n<span class="op">=</span><span class="va">n</span><span class="op">)</span>
 <span class="co">#estimating fct for or:control grp</span>
  <span class="va">est.or.fct.trt01</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/est.fct.or.html">est.fct.or</a></span><span class="op">(</span>eta<span class="op">=</span><span class="va">est.or.wrong2.all</span>,pseudo_y<span class="op">=</span><span class="va">pseudo_y.trt0.wrong2</span>,trt<span class="op">=</span><span class="fl">0</span>,n<span class="op">=</span><span class="va">n</span><span class="op">)</span>
  <span class="va">est.or.fct.trt02</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/est.fct.or.html">est.fct.or</a></span><span class="op">(</span>eta<span class="op">=</span><span class="va">est.or.wrong1.all</span>,pseudo_y<span class="op">=</span><span class="va">pseudo_y.trt0.wrong1</span>,trt<span class="op">=</span><span class="fl">0</span>,n<span class="op">=</span><span class="va">n</span><span class="op">)</span>

  
<span class="co">#calculate multiple robust propensity score with or given one right models for both iptw and or</span>

  <span class="va">Prop_multir_ww</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/multir.propensity.or.html">multir.propensity.or</a></span><span class="op">(</span>prob_fit1<span class="op">=</span><span class="va">prob_fitted_wrong2</span>, prob_fit2<span class="op">=</span><span class="va">prob_fitted_wrong</span>, or_fit11<span class="op">=</span><span class="va">est.or.fct.trt11</span>, or_fit12<span class="op">=</span><span class="va">est.or.fct.trt12</span>, or_fit01<span class="op">=</span><span class="va">est.or.fct.trt01</span>, or_fit02<span class="op">=</span><span class="va">est.or.fct.trt02</span>, trt_ind<span class="op">=</span><span class="va">trt_a</span><span class="op">)</span>

  <span class="va">eta_multir_ww</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/multir.est.html">multir.est</a></span><span class="op">(</span>Prop_multir<span class="op">=</span><span class="va">Prop_multir_ww</span>,trt_ind<span class="op">=</span><span class="va">trt_a</span>,main_outcome<span class="op">=</span><span class="va">yy</span><span class="op">)</span>
  <span class="va">eta_multir_ww</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">-</span><span class="va">casual_effect</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="the-model-based-on-emultir-method-with-information-borrow-from-the-secondary-outcomes">The model based on eMultiR method with information borrow from the
secondary outcomes<a class="anchor" aria-label="anchor" href="#the-model-based-on-emultir-method-with-information-borrow-from-the-secondary-outcomes"></a>
</h2>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="co">#MinBo: one secondary outcome situation</span>
  <span class="va">r</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>
  <span class="va">Prop_scores</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/MinBo.one.html">MinBo.one</a></span><span class="op">(</span>s.outcome<span class="op">=</span><span class="va">y</span>,cov.mat<span class="op">=</span><span class="va">x</span>,n<span class="op">=</span><span class="va">n</span>,proportion<span class="op">=</span><span class="va">proportion</span>,time<span class="op">=</span><span class="va">time</span>,r<span class="op">=</span><span class="va">r</span>,id<span class="op">=</span><span class="va">id</span>,dist<span class="op">=</span><span class="st">"gaussian"</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Prop_scores</span><span class="op">)</span></code></pre></div>
<p>Calculate the estimate bias</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">eta_emultir_ww</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/multir.ib.est.html">multir.ib.est</a></span><span class="op">(</span>Prop_multir<span class="op">=</span><span class="va">Prop_multir_ww</span>,Prop_scores<span class="op">=</span><span class="va">Prop_scores</span>,trt_ind<span class="op">=</span><span class="va">trt_a</span>,main_outcome<span class="op">=</span><span class="va">yy</span><span class="op">)</span>
<span class="va">eta_emultir_ww</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">-</span><span class="va">casual_effect</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="make-a-figure-for-bias-evaluation">Make a figure for bias evaluation<a class="anchor" aria-label="anchor" href="#make-a-figure-for-bias-evaluation"></a>
</h2>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">est_all</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">eta_emultir_ww</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="va">eta_multir_ww</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="va">est.dr.ww</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="va">est_cm</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span>,<span class="va">eta_iptw</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">est_all</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"eMultiR_ww"</span>,<span class="st">"MultiR_ww"</span>,<span class="st">"DR_ww"</span>,
                  <span class="st">"CM_r"</span>,<span class="st">"CM_w1"</span>,<span class="st">"CM_w2"</span>,
                  <span class="st">"IPTW_r"</span>,<span class="st">"IPTW_w1"</span>,<span class="st">"IPTW_w2"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">est_all</span>,<span class="st">"/Users/chixiang.chen/Library/CloudStorage/OneDrive-UniversityofMarylandSchoolofMedicine/research_mingwang/causal/package_results/est_all.rds"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="read-estimate-results-directly">Read estimate results directly<a class="anchor" aria-label="anchor" href="#read-estimate-results-directly"></a>
</h2>
<p>The user can skip the above codes and run the following codes to
visualize the results. It can be seen below that the eMultiR estimates
with/without information borrow show much less estimation bias compared
to other estimates Note that when the PS or CM model is right, then
IPTW_r and CM_r estimates have small bias, whereas when the PS or CM
models are wrong, existing estimates have large bias. The eMultiR
estimates are still satisfactory even if all candidate models are
wrong.</p>
<p>Note that the result relies the data from only one simulation. More
rigorous evaluation should be done by multiple simulation runs (eg., 100
runs).</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">est_all</span><span class="op">&lt;-</span><span class="fu">readRDSFromWeb</span><span class="op">(</span><span class="st">"https://github.com/chencxxy28/eMultiR/raw/main/vignettes/data/est_all.rds"</span><span class="op">)</span>
<span class="va">data.bar</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Bias<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">est_all</span><span class="op">-</span><span class="va">casual_effect</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span>,
                     Method<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">est_all</span><span class="op">)</span><span class="op">)</span>
<span class="va">p</span><span class="op">&lt;-</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">data.bar</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Method</span>, y<span class="op">=</span><span class="va">Bias</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span>, fill<span class="op">=</span><span class="st">"steelblue"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="va">Bias</span><span class="op">)</span>,vjust<span class="op">=</span><span class="fl">1.6</span>, color<span class="op">=</span><span class="st">"white"</span>, size<span class="op">=</span><span class="fl">3.5</span><span class="op">)</span><span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle<span class="op">=</span><span class="fl">30</span>,hjust<span class="op">=</span><span class="fl">1</span>,vjust<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>
<span class="va">p</span></code></pre></div>
<p><img src="NAME-OF-VIGNETTE_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
</div>
</div>
<div class="section level1">
<h1 id="calculate-the-bootstrapping-estimation-standard-deviation-for-the-emultir-estimate">Calculate the bootstrapping estimation standard deviation for the
eMultiR estimate<a class="anchor" aria-label="anchor" href="#calculate-the-bootstrapping-estimation-standard-deviation-for-the-emultir-estimate"></a>
</h1>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Chixiang Chen.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.1.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
